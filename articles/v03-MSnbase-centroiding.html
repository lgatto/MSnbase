<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MSnbase: centroiding of profile-mode MS data • MSnbase</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MSnbase: centroiding of profile-mode MS data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSnbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.35.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a></li>
    <li><a class="dropdown-item" href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a></li>
    <li><a class="dropdown-item" href="../articles/v04-benchmarking.html">MSnbase benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/MSnbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MSnbase: centroiding of profile-mode MS data</h1>
                        <h4 data-toc-skip class="author">Johannes
Rainer</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/lgatto/MSnbase/blob/master/vignettes/v03-MSnbase-centroiding.Rmd" class="external-link"><code>vignettes/v03-MSnbase-centroiding.Rmd</code></a></small>
      <div class="d-none name"><code>v03-MSnbase-centroiding.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette describes the use of the MSnbase package for
      centroiding of profile-mode mass spectrometry data.</p>
    </div>
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Mass spectrometry measures data in so called <em>profile mode</em>,
were the signal corresponding to a specific ion is distributed around
the ion’s actual m/z value <span class="citation">(Smith et al.
2014)</span>. The accuracy of that signal depends on the resolution and
settings of the instrument. Profile mode data can be processed into
<em>centroid</em> data by retaining only a single, representative value,
typically the local maximum of the distribution of data points. This
<em>centroiding</em> substantially reduces the amount of data without
much loss of information. Certain algorithms, such as the
<em>centWave</em> method in the <em><a href="https://bioconductor.org/packages/3.21/xcms" class="external-link">xcms</a></em> package
for chromatographic peak detection in LC-MS experiments or proteomics
search engines that match MS2 spectra to peptides, require the data to
be in centroid mode. In this vignette, we will focus on metabolomics
data.</p>
<p>Many manufacturers apply centroiding of the profile data, either
directly during the acquisition or immediately thereafter so that the
user immediately receives processed data. Alternatively, third party
software, such as <code>msconvert</code> from the
<code>proteowizard</code> suite <span class="citation">(Chambers et al.
2012)</span> allow to apply various data centroiding algorithms,
including vendor methods. In some cases however, the software provided
by some vendors generate centroided data of poor quality.
<code>MSnbase</code> also provides some functionality to perform
centroiding of profile MS data. These processed data can then be further
quantified or analysed within R or serialised to <em>mzML</em> files,
and used as input for other software.</p>
</div>
<div class="section level2">
<h2 id="centroiding-of-profile-mode-ms-data">Centroiding of profile-mode MS data<a class="anchor" aria-label="anchor" href="#centroiding-of-profile-mode-ms-data"></a>
</h2>
<p>In this vignette we use a subset of a metabolomics profile-mode LC-MS
data of pooled human serum samples measured on a AB Sciex TripleTOF
5600+ mass spectrometer (the employed chromatography was a hydrophilic
interaction high-performance liquid chromatography (HILIC HPLC)). The
mzML file contains profile mode data for an m/z range from 105 to 130
and a retention time from 0 to 240 seconds. For more details on the
sample see <code><a href="https://rdrr.io/pkg/msdata/man/sciexdata.html" class="external-link">?msdata::sciexdata</a></code>. Below we load the required
packages and read the MS data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://lgatto.github.io/MSnbase">"MSnbase"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"msdata"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://magrittr.tidyverse.org" class="external-link">"magrittr"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sciex"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "20171016_POOL_POS_3_105-134.mzML"</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_prof</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readMSData.html">readMSData</a></span><span class="op">(</span><span class="va">fl</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span>, centroided <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We next extract the profile MS data for the [M+H]+ adduct of serine
with the expected m/z of 106.049871. We thus filter the
<code>data_prof</code> object using an m/z range containing the signal
for the metabolite and a retention time window from 175 to 187 seconds
corresponding to the time when the analyte elutes from the LC.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define the mz and retention time ranges</span></span>
<span><span class="va">serine_mz</span> <span class="op">&lt;-</span> <span class="fl">106.049871</span></span>
<span><span class="va">mzr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">serine_mz</span> <span class="op">-</span> <span class="fl">0.01</span>, <span class="va">serine_mz</span> <span class="op">+</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">rtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">175</span>, <span class="fl">187</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Filtering the object</span></span>
<span><span class="va">serine</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">mzr</span><span class="op">)</span></span></code></pre></div>
<p>We can now plot the profile MS data for serine.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">serine</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">serine_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/serine-plot-1.png" alt="MS profile data for serine. Upper panel shows the base peak chromatogram (BPC), lower panel the individual signals in the retention time - m/z space. The horizontal dashed red line indicates the theoretical m/z of the [M+H]+ adduct of serine." width="700"><p class="caption">
MS profile data for serine. Upper panel shows the base peak chromatogram
(BPC), lower panel the individual signals in the retention time - m/z
space. The horizontal dashed red line indicates the theoretical m/z of
the [M+H]+ adduct of serine.
</p>
</div>
<p>The lower panel in the plot above shows all the individual signal
intensities measured by the mass spectrometer over the retention time
and the m/z ranges of interest. The upper panel displays the <em>base
peak chromatogram</em> (BPC), which represents the maximum signal
(across the range of m/z values) for each discrete retention time. The
rows of points in this lower panel indicate the resolution of the mass
spectrometer while the columns of data points (i.e. the data collected
for a discrete retention time point) represents the signal for the ion
in one spectrum.</p>
<p>Below we plot the signal for one of of the 43 spectra containing
signal for serine, the one at retention time 181.07</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">serine</span><span class="op">[[</span><span class="fl">22</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/serine-spectrum24-1.png" alt="On of the spectra for serine in profile mode." width="700"><p class="caption">
On of the spectra for serine in profile mode.
</p>
</div>
<p>The MS instrument recorded a signal along the m/z range in discrete
intervals (which depend on the resolution of the instrument). The
profile-mode signal of the serine ion at the respective retention time
(the <em>mass peak</em>) consists therefore of multiple intensities that
follow approximately a gaussian distribution.</p>
<p>As described in the introduction, centroiding aims to reduce this
signal distribution to a single representative intensity, a single data
point, for the ion in a spectrum. The simplest approach selects the
largest intensity for each mass peak and report its intensity and m/z
value. This can be done using the <code>pickPeaks</code> method with
default parameters as shown below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_cent</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">serine_cent</span> <span class="op">&lt;-</span> <span class="va">data_cent</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the centroided data for serine</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">serine_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">serine_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/simple-pickPeaks-1.png" alt="Centroided data for serine." width="700"><p class="caption">
Centroided data for serine.
</p>
</div>
<p>After centroiding the data consists of a single intensity for each
mass peak. In the example above the centroids from consecutive scans do
however not have the same m/z value, but they fluctuate between the
discrete m/z values defined by the instruments’s resolution. For lower
intensity signals this variation can be substantial.</p>
<p>To further illustrate this, we plot below the centroided signal for
the [M+H]+ ion of proline.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prol_mz</span> <span class="op">&lt;-</span> <span class="fl">116.070608</span></span>
<span><span class="va">prol_mzr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prol_mz</span> <span class="op">-</span> <span class="fl">0.01</span>, <span class="va">prol_mz</span> <span class="op">+</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">prol_rtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">165</span>, <span class="fl">175</span><span class="op">)</span></span>
<span></span>
<span><span class="va">proline</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">prol_rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">prol_mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">proline</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">prol_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/proline-1.png" alt="Centroided data for proline." width="700"><p class="caption">
Centroided data for proline.
</p>
</div>
<p>For proline, the centroids jump between 3 bins of m/z values in
consecutive scans and the chromatographic data does not show a nice,
regular peak shape. Additional data processing, such as data smoothing
prior to centroiding and/or <em>refining</em> the centroid’s m/z can
reduce these effects and improve overall data quality as we will see in
the next section.</p>
</div>
<div class="section level2">
<h2 id="improving-the-signal-quality">Improving the signal quality<a class="anchor" aria-label="anchor" href="#improving-the-signal-quality"></a>
</h2>
<p>While the simple centroiding using <code>pickPeaks</code> as
described in the previous section might be sufficient for many
experiments and setups, MS data smoothing and refinement of the
identified centroids’ m/z values can improve data quality.</p>
<div class="section level3">
<h3 id="sec:smoothing">Data smoothing<a class="anchor" aria-label="anchor" href="#sec:smoothing"></a>
</h3>
<p>Raw mass spectrometry data is usually smoothed in m/z dimension by
applying e.g. a Savitzky-Golay filter <span class="citation">(Savitzky
and Golay 1964)</span> which reduces the noise and hence improves data
quality. Below we use the <code>smooth</code> method to apply a
Savitzky-Golay filter with a half-window size of 4 to the data within
each spectrum (see <code><a href="../reference/smooth-methods.html">?smooth</a></code> for more details on the
parameters).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sg</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/smooth-methods.html">smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"SavitzkyGolay"</span>, halfWindowSize <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span></code></pre></div>
<p>We next apply the simple peak picking on the smoothed data, filter
the desired retention time and m/z ranges, and subsequently plot the
such centroided data for serine.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sg_cent</span> <span class="op">&lt;-</span> <span class="va">data_sg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">pickPeaks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the centroided data for serine</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">data_sg_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">serine_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/smoothSG-pp-serine-1.png" alt="Centroided data for serine after smoothing with a Savitzky-Golay filter." width="700"><p class="caption">
Centroided data for serine after smoothing with a Savitzky-Golay filter.
</p>
</div>
<p>Smoothing the raw data prior to peak picking improved the quality of
the centroided data of serine as well as proline as can be seen
below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prol_sg_cent</span> <span class="op">&lt;-</span> <span class="va">data_sg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">pickPeaks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">prol_rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">prol_mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">prol_sg_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">prol_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/smoothSG-pp-proline-1.png" alt="Centroided data for proline after smoothing with a Savitzky-Golay filter." width="700"><p class="caption">
Centroided data for proline after smoothing with a Savitzky-Golay
filter.
</p>
</div>
<p>The smoothed centroided data for proline still show a systematic
deviation of m/z values as well as poor chromatographic data.</p>
<p>In addition to smoothing the signal in m/z dimension, we can also
smooth the signal along the retention time dimension using the
<code>combineSpectraMovingWindow</code> function. This function
aggregates signal for the same m/z value from neighbouring spectra in a
moving window approach, thus smoothing the chromatographic data (by
replacing the intensity in the middle spectrum by the average signal of
all intensities for the m/z in the spectra within the defined window).
To reduce the run-time of the example we apply the smoothing only to the
profile-mode data for a retention time window containing proline (in a
real data analysis this should be performed on the full data).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Subset to the data for proline, smooth it in rt dimension and</span></span>
<span><span class="co">## perform the centroiding</span></span>
<span><span class="va">proline_c_cent</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">prol_rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/combineSpectraMovingWindow.html">combineSpectraMovingWindow</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">prol_mzr</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">proline_c_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">prol_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/proline-rtsmooth-1.png" alt="Centroided data for proline after smoothing in retention time dimension." width="700"><p class="caption">
Centroided data for proline after smoothing in retention time dimension.
</p>
</div>
<p>As can be seen above, smoothing in retention time dimension improves
the chromatographic peak shape of proline.</p>
<p>Note however that, to combine data from multiple spectra, the
<code>combineSpectraMovingWindow</code> function has to first load the
full data into memory (i.e. it converts the <code>OnDiskMSnExp</code>
object into a <code>MSnExp</code> object) and that it returns also a
<code>MSnExp</code> object. In a real use case it is thus advisable to
apply <code>combineSpectraMovingWindow</code> separately on each file of
an experiment and to export the results as an <em>mzML</em> file using
the <code>writeMSData</code> method.</p>
</div>
<div class="section level3">
<h3 id="sec:refine">Refinement of the centroid’s m/z values<a class="anchor" aria-label="anchor" href="#sec:refine"></a>
</h3>
<p>Thus far we applied only a simple peak picking strategy, but the
<code>pickPeaks</code> method allows also to <em>refine</em> the
identified centroid’s m/z value by considering also the signal from the
full, or parts of the, mass peak. Currently two methods are implemented,
<em>descendPeak</em> and <em>kNeighbors</em> that can be selected by
passing either <code>refineMz = "descendPeak"</code> or
<code>refineMz = "kNeighbors"</code> to the <code>pickPeaks</code>
method. The m/z value of the reported centroid is calculated using an
intensity-weighted mean of m/z-intensity values from the mass peak. This
can improve the accuracy of the reported m/z values. The two methods
differ only in the way in which the peak area for the final calculation
is defined: <code>kNeighbors</code> takes the <code>k</code>
m/z-intensity pairs (default <code>k = 2</code>) left and right of the
centroid and <code>descendPeak</code> walks, on both sides from the
centroid, down until the signal is below <code>signalPercentage</code>%
of the centroid’s intensity (by default 33%), or until the signal
increases again. All m/z intensity pairs within this range are used for
the weighted average calculation of the centroid’s m/z value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use pickPeaks with descendPeak m/z refinement</span></span>
<span><span class="va">data_sg_cent_mz</span> <span class="op">&lt;-</span> <span class="va">data_sg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span>refineMz <span class="op">=</span> <span class="st">"descendPeak"</span><span class="op">)</span></span></code></pre></div>
<p>Below we first extract the data for serine and then plot the smoothed
and centroided data without and with m/z refinement.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract the data for serine</span></span>
<span><span class="va">serine_sg_cent</span> <span class="op">&lt;-</span> <span class="va">data_sg_cent</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">serine_sg_cent_mz</span> <span class="op">&lt;-</span> <span class="va">data_sg_cent_mz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## No m/z refinement</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">serine_sg_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span>, layout <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">serine_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../reference/Spectrum-class.html">rtime</a></span><span class="op">(</span><span class="va">serine_sg_cent</span><span class="op">)</span><span class="op">[</span><span class="fl">22</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">## With m/z refinement</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">serine_sg_cent_mz</span>, type <span class="op">=</span> <span class="st">"XIC"</span>, layout <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">serine_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../reference/Spectrum-class.html">rtime</a></span><span class="op">(</span><span class="va">serine_sg_cent_mz</span><span class="op">)</span><span class="op">[</span><span class="fl">22</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/refineMz-serine-1.png" alt="Smoothed and centroided data for serine without (left) and with m/z refinement (right). The horizontal red dashed line indicates the theoretical m/z for the [M+H]+ ion and the vertical red dotted line the position of the largest signal for serine." width="700"><p class="caption">
Smoothed and centroided data for serine without (left) and with m/z
refinement (right). The horizontal red dashed line indicates the
theoretical m/z for the [M+H]+ ion and the vertical red dotted line the
position of the largest signal for serine.
</p>
</div>
<p>As shown above (right), the accuracy of the centroided data with m/z
refinement was improved, where the difference between the largest signal
centroids’ m/z value and the theoretical m/z value for the [M+H]+ ion of
serine is reduced.</p>
<p>For the simple peak picking on raw data the difference is:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## only centroided</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">data_cent</span>, <span class="va">rtr</span><span class="op">)</span>, <span class="va">mzr</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">22</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">serine_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.0003682412</span></span></code></pre>
<p>Smoothing already improves the accuracy:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## smoothed and centroided</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">serine_sg_cent</span><span class="op">)</span><span class="op">[[</span><span class="fl">22</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">serine_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.0003682412</span></span></code></pre>
<p>And refining the m/z value during the centroiding can improve
accuracy even more:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## smoothed and centroided with m/z refinement</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">serine_sg_cent_mz</span><span class="op">)</span><span class="op">[[</span><span class="fl">22</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">serine_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.0001703475</span></span></code></pre>
<p>Similarly, the m/z refinement also improved the accuracy for
proline.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proline_sg_cent</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/smooth-methods.html">smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"SavitzkyGolay"</span>, halfWindowSize <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">prol_rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">prol_mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">proline_sg_cent_mz</span> <span class="op">&lt;-</span> <span class="va">data_prof</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/smooth-methods.html">smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"SavitzkyGolay"</span>, halfWindowSize <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span>refineMz <span class="op">=</span> <span class="st">"descendPeak"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">prol_rtr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="va">prol_mzr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">proline_sg_cent</span>, type <span class="op">=</span> <span class="st">"XIC"</span>, layout <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">prol_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../reference/Spectrum-class.html">rtime</a></span><span class="op">(</span><span class="va">proline_sg_cent_mz</span><span class="op">)</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">proline_sg_cent_mz</span>, type <span class="op">=</span> <span class="st">"XIC"</span>, layout <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">prol_mz</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../reference/Spectrum-class.html">rtime</a></span><span class="op">(</span><span class="va">proline_sg_cent_mz</span><span class="op">)</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="v03-MSnbase-centroiding_files/figure-html/refineMz-proline-1.png" alt="Smoothed and centroided data for proline without (left) and with m/z refinement (right). The horizontal red dashed line indicates the theoretical m/z for the [M+H]+ ion and the vertical red dotted line the position of the maximum signal." width="700"><p class="caption">
Smoothed and centroided data for proline without (left) and with m/z
refinement (right). The horizontal red dashed line indicates the
theoretical m/z for the [M+H]+ ion and the vertical red dotted line the
position of the maximum signal.
</p>
</div>
<p>The difference between the m/z of the centroid with the largest
signal and the theoretical m/z for the [M+H]+ ion of proline is shown
below.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## only centroiding</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="fu"><a href="../reference/trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="fu"><a href="../reference/MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">data_cent</span>, <span class="va">prol_rtr</span><span class="op">)</span>, <span class="va">prol_mzr</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">prol_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.001577028</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## smoothed and centroided</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">proline_sg_cent</span><span class="op">)</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">prol_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.75261e-05</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## smoothed and centroided with m/z refinement</span></span>
<span><span class="fu"><a href="../reference/Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">proline_sg_cent_mz</span><span class="op">)</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">prol_mz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -3.241556e-05</span></span></code></pre>
<p>Summarizing, smoothing raw profile MS data, e.g. by applying a
Savitzky-Golay filter, improves quality considerably. Additional
smoothing in retention time dimension can be advantageous too,
specifically for the chromatographic peak shape. Accuracy can be further
improved for smoothed profile MS data by refining the m/z value of the
identified centroids.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Chambers:2012" class="csl-entry">
Chambers, M C, B Maclean, R Burke, D Amodei, D L Ruderman, S Neumann, L
Gatto, et al. 2012. <span>“A Cross-Platform Toolkit for Mass
Spectrometry and Proteomics.”</span> <em>Nat Biotechnol</em> 30 (10):
918–20. <a href="https://doi.org/10.1038/nbt.2377" class="external-link">https://doi.org/10.1038/nbt.2377</a>.
</div>
<div id="ref-Savitzky:1964bn" class="csl-entry">
Savitzky, Abraham, and M J E Golay. 1964. <span>“<span class="nocase">Smoothing and Differentiation of Data by Simplified Least
Squares Procedures.</span>”</span> <em>Analytical Chemistry</em> 36 (8):
1627–39.
</div>
<div id="ref-Smith:2014di" class="csl-entry">
Smith, Rob, Andrew D Mathis, Dan Ventura, and John T Prince. 2014.
<span>“<span class="nocase">Proteomics, lipidomics, metabolomics: a mass
spectrometry tutorial from a computer scientist’s point of
view.</span>”</span> <em>BMC Bioinformatics</em> 15 Suppl 7 (Suppl 7):
S9.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
