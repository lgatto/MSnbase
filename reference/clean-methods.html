<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances — clean-methods • MSnbase</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances — clean-methods"><meta name="description" content="This method cleans out individual spectra (Spectrum instances),
  chromatograms (Chromatogram instances)
  or whole experiments (MSnExp instances) of 0-intensity
  peaks. Unless all is set to FALSE, original 0-intensity
  values are retained only around peaks. If more than two 0's were
  separating two peaks, only the first and last ones, those directly
  adjacent to the peak ranges are kept. If two peaks are separated by
  only one 0-intensity value, it is retained. An illustrative example is
  shown below."><meta property="og:description" content="This method cleans out individual spectra (Spectrum instances),
  chromatograms (Chromatogram instances)
  or whole experiments (MSnExp instances) of 0-intensity
  peaks. Unless all is set to FALSE, original 0-intensity
  values are retained only around peaks. If more than two 0's were
  separating two peaks, only the first and last ones, those directly
  adjacent to the peak ranges are kept. If two peaks are separated by
  only one 0-intensity value, it is retained. An illustrative example is
  shown below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSnbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.33.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a></li>
    <li><a class="dropdown-item" href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a></li>
    <li><a class="dropdown-item" href="../articles/v04-benchmarking.html">MSnbase benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/MSnbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances</h1>

      <div class="d-none name"><code>clean-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method cleans out individual spectra (<code>Spectrum</code> instances),
  chromatograms (<code><a href="Chromatogram-class.html">Chromatogram</a></code> instances)
  or whole experiments (<code>MSnExp</code> instances) of 0-intensity
  peaks. Unless <code>all</code> is set to <code>FALSE</code>, original 0-intensity
  values are retained only around peaks. If more than two 0's were
  separating two peaks, only the first and last ones, those directly
  adjacent to the peak ranges are kept. If two peaks are separated by
  only one 0-intensity value, it is retained. An illustrative example is
  shown below.</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    <p></p><dl><dt><code>signature(object = "MSnExp", all = "logical", verbose =
        "logical")</code></dt>
<dd><p>Cleans all spectra in <code>MSnExp</code>
      object. Displays a control bar if verbose set to <code>TRUE</code>
      (default). Returns a cleaned <code>MSnExp</code> instance.</p></dd>


    <dt><code>signature(object = "Spectrum", all = "logical",
        msLevel. = "numeric")</code></dt>
<dd><p>Cleans the <code>Spectrum</code>
      object. Returns a cleaned <code>Spectrum</code> instance. If <code>all
        = TRUE</code>, then all zeros are removed. <code>msLevel.</code> defines the
      level of the spectrum, and if <code>msLevel(object) !=
        msLevel.</code>, cleaning is ignored. Only relevant when called from
      <code>OnDiskMSnExp</code> and is only relevant for developers.</p></dd>


    <dt><code>signature(object = "Chromatogram", all = "logical",
        na.rm = "logical")</code></dt>
<dd><p>Cleans the <code><a href="Chromatogram-class.html">Chromatogram</a></code> instance and returns
      a cleaned <code><a href="Chromatogram-class.html">Chromatogram</a></code> object. If
      <code>na.rm</code> is <code>TRUE</code> (default is <code>FALSE</code>) all
      <code>NA</code> intensities are removed before cleaning the chromatogram.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="removePeaks-methods.html">removePeaks</a></code> and <code><a href="trimMz-methods.html">trimMz</a></code> for other spectra
  processing methods.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"Spectrum2"</span>,</span></span>
<span class="r-in"><span>           intensity<span class="op">=</span><span class="va">int</span>,</span></span>
<span class="r-in"><span>           mz<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="pSet-class.html">length</a></span><span class="op">(</span><span class="va">int</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp2</span> <span class="op">&lt;-</span> <span class="fu">clean</span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span> <span class="co">## default is all=FALSE</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0</span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="va">sp2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 1 1 1 0 0 1 1 0 0 1 0</span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="fu">clean</span><span class="op">(</span><span class="va">sp1</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] 26 27 28 29 30 31 32</span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">mz</a></span><span class="op">(</span><span class="va">sp2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  2  8  9 10 11 12 16 17 18 19 28 29 30</span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">mz</a></span><span class="op">(</span><span class="fu">clean</span><span class="op">(</span><span class="va">sp1</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  9 10 11 17 18 29</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itraqdata2</span> <span class="op">&lt;-</span> <span class="fu">clean</span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="Spectrum-class.html">peaksCount</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 106289</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="Spectrum-class.html">peaksCount</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 59747</span>
<span class="r-in"><span><span class="fu"><a href="pSet-class.html">processingData</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - - - Processing information - - -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data loaded: Wed May 11 18:54:39 2011 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated from version 0.3.0 to 0.3.1 [Fri Jul  8 20:23:25 2016] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spectra cleaned: Mon Mar 17 11:30:54 2025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MSnbase version: 1.1.22 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a simple Chromatogram object</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="Chromatogram-class.html">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span></span>
<span class="r-in"><span>                    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">123</span>, <span class="fl">124343</span>, <span class="fl">3432</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Remove 0-intensity values keeping those adjacent to peaks</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu">clean</span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]      0     20      0      0    123 124343   3432      0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Remove all 0-intensity values</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu">clean</span><span class="op">(</span><span class="va">chr</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]     20    123 124343   3432</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Clean a Chromatogram with NAs.</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="Chromatogram-class.html">Chromatogram</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span></span>
<span class="r-in"><span>                    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">123</span>, <span class="fl">124343</span>, <span class="fl">3432</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu">clean</span><span class="op">(</span><span class="va">chr</span>, all <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Spectrum-class.html">intensity</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]      0     20      0    123 124343   3432      0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

