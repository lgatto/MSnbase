<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances — clean-methods • MSnbase</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances — clean-methods" />
<meta property="og:description" content="This method cleans out individual spectra (Spectrum instances),
  chromatograms (Chromatogram instances)
  or whole experiments (MSnExp instances) of 0-intensity
  peaks. Unless all is set to FALSE, original 0-intensity
  values are retained only around peaks. If more than two 0's were
  separating two peaks, only the first and last ones, those directly
  adjacent to the peak ranges are kept. If two peaks are separated by
  only one 0-intensity value, it is retained. An illustrative example is
  shown below." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.17.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lgatto/MSnbase/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clean 'MSnExp', 'Spectrum' or 'Chromatogram' instances</h1>
    
    <div class="hidden name"><code>clean-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method cleans out individual spectra (<code>Spectrum</code> instances),
  chromatograms (<code><a href='Chromatogram.html'>Chromatogram</a></code> instances)
  or whole experiments (<code>MSnExp</code> instances) of 0-intensity
  peaks. Unless <code>all</code> is set to <code>FALSE</code>, original 0-intensity
  values are retained only around peaks. If more than two 0's were
  separating two peaks, only the first and last ones, those directly
  adjacent to the peak ranges are kept. If two peaks are separated by
  only one 0-intensity value, it is retained. An illustrative example is
  shown below.</p>
    </div>



    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p></p><dl>
    <dt><code>signature(object = "MSnExp", all = "logical", verbose =
	"logical")</code></dt><dd><p>Cleans all spectra in <code>MSnExp</code>
      object. Displays a control bar if verbose set to <code>TRUE</code>
      (default). Returns a cleaned <code>MSnExp</code> instance.</p></dd>

    <dt><code>signature(object = "Spectrum", all = "logical",
	msLevel. = "numeric")</code></dt><dd><p>Cleans the <code>Spectrum</code>
      object. Returns a cleaned <code>Spectrum</code> instance. If <code>all
	= TRUE</code>, then all zeros are removed. <code>msLevel.</code> defines the
      level of the spectrum, and if <code>msLevel(object) !=
	msLevel.</code>, cleaning is ignored. Only relevant when called from
      <code>OnDiskMSnExp</code> and is only relevant for developers.</p></dd>

    <dt><code>signature(object = "Chromatogram", all = "logical",
	na.rm = "logical")</code></dt><dd><p>Cleans the <code><a href='Chromatogram.html'>Chromatogram</a></code> instance and returns
      a cleaned <code><a href='Chromatogram.html'>Chromatogram</a></code> object. If
      <code>na.rm</code> is <code>TRUE</code> (default is <code>FALSE</code>) all
      <code>NA</code> intensities are removed before cleaning the chromatogram.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Laurent Gatto &lt;lg390@cam.ac.uk&gt;</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='removePeaks-methods.html'>removePeaks</a></code> and <code><a href='trimMz-methods.html'>trimMz</a></code> for other spectra
  processing methods.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>int</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>sp1</span> <span class='op'>&lt;-</span> <span class='fu'>new</span><span class='op'>(</span><span class='st'>"Spectrum2"</span>,
           intensity<span class='op'>=</span><span class='va'>int</span>,
           mz<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>int</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sp2</span> <span class='op'>&lt;-</span> <span class='fu'>clean</span><span class='op'>(</span><span class='va'>sp1</span><span class='op'>)</span> <span class='co'>## default is all=FALSE</span>
<span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>sp1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 1 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0</div><div class='input'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>sp2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 1 0 0 1 1 1 0 0 1 1 0 0 1 0</div><div class='input'><span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='fu'>clean</span><span class='op'>(</span><span class='va'>sp1</span>, all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1 1 1 1 1 1 1</div><div class='input'>
<span class='fu'><a href='Spectrum-class.html'>mz</a></span><span class='op'>(</span><span class='va'>sp1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
#&gt; [26] 26 27 28 29 30 31 32</div><div class='input'><span class='fu'><a href='Spectrum-class.html'>mz</a></span><span class='op'>(</span><span class='va'>sp2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1]  1  2  8  9 10 11 12 16 17 18 19 28 29 30</div><div class='input'><span class='fu'><a href='Spectrum-class.html'>mz</a></span><span class='op'>(</span><span class='fu'>clean</span><span class='op'>(</span><span class='va'>sp1</span>, all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  1  9 10 11 17 18 29</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>itraqdata</span><span class='op'>)</span>
<span class='va'>itraqdata2</span> <span class='op'>&lt;-</span> <span class='fu'>clean</span><span class='op'>(</span><span class='va'>itraqdata</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>peaksCount</a></span><span class='op'>(</span><span class='va'>itraqdata</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 106289</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='Spectrum-class.html'>peaksCount</a></span><span class='op'>(</span><span class='va'>itraqdata2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 59747</div><div class='input'><span class='fu'><a href='pSet-class.html'>processingData</a></span><span class='op'>(</span><span class='va'>itraqdata2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; - - - Processing information - - -
#&gt; Data loaded: Wed May 11 18:54:39 2011 
#&gt; Updated from version 0.3.0 to 0.3.1 [Fri Jul  8 20:23:25 2016] 
#&gt; Spectra cleaned: Sun Dec 27 20:11:25 2020 
#&gt;  MSnbase version: 1.1.22 </div><div class='input'>
<span class='co'>## Create a simple Chromatogram object</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Chromatogram.html'>Chromatogram</a></span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span>,
                    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>20</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>123</span>, <span class='fl'>124343</span>, <span class='fl'>3432</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Remove 0-intensity values keeping those adjacent to peaks</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'>clean</span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span>
<span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]      0     20      0      0    123 124343   3432      0</div><div class='input'>
<span class='co'>## Remove all 0-intensity values</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'>clean</span><span class='op'>(</span><span class='va'>chr</span>, all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]     20    123 124343   3432</div><div class='input'>
<span class='co'>## Clean a Chromatogram with NAs.</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Chromatogram.html'>Chromatogram</a></span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span>,
                    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>20</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>0</span>, <span class='fl'>123</span>, <span class='fl'>124343</span>, <span class='fl'>3432</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'>clean</span><span class='op'>(</span><span class='va'>chr</span>, all <span class='op'>=</span> <span class='cn'>FALSE</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='Spectrum-class.html'>intensity</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]      0     20      0    123 124343   3432      0</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


