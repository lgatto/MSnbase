<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Combines features in an MSnSet object — combineFeatures • MSnbase</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Combines features in an MSnSet object — combineFeatures"><meta property="og:description" content='

This function combines the features in an
  "MSnSet" instance applying a summarisation
  function (see fun argument) to sets of features as defined by a
  factor (see fcol argument).  Note that the feature names are
  automatically updated based on the groupBy parameter.
The coefficient of variations are automatically computed and collated
  to the featureData slot. See cv and cv.norm arguments
  for details.
If NA values are present, a message will be shown. Details on how
  missing value impact on the data aggregation are provided below.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.31.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lgatto/MSnbase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Combines features in an <code>MSnSet</code> object</h1>
    
    <div class="hidden name"><code>combineFeatures.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>This function combines the features in an
  <code>"<a href="MSnSet-class.html">MSnSet</a>"</code> instance applying a summarisation
  function (see <code>fun</code> argument) to sets of features as defined by a
  factor (see <code>fcol</code> argument).  Note that the feature names are
  automatically updated based on the <code>groupBy</code> parameter.</p>
<p>The coefficient of variations are automatically computed and collated
  to the featureData slot. See <code>cv</code> and <code>cv.norm</code> arguments
  for details.</p>
<p>If NA values are present, a message will be shown. Details on how
  missing value impact on the data aggregation are provided below.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>"<a href="MSnSet-class.html">MSnSet</a>"</code>
    whose features will be summerised.</p></dd>


  <dt id="arg-groupby">groupBy<a class="anchor" aria-label="anchor" href="#arg-groupby"></a></dt>
<dd><p>A <code>factor</code>, <code>character</code>, <code>numeric</code> or a
    <code>list</code> of the above defining how to summerise the features. The
    list must be of length <code>nrow(object)</code>. Each element of the list
    is a vector describing the feature mapping. If the list can be
    named, its names must match <code>fetureNames(object)</code>. See
    <code>redundancy.handler</code> for details about the latter.</p></dd>


  <dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Deprecated; use <code>method</code> instead.</p></dd>


  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The summerising function. Currently, mean, median,
    weighted mean, sum, median polish, robust summarisation (using
    <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::rlm</a></code>, implemented in
    <code><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">MsCoreUtils::robustSummary()</a></code>), iPQF (see <code><a href="iPQF.html">iPQF</a></code>
    for details) and NTR (see <code><a href="normToReference.html">NTR</a></code> for details) are
    implemented, but user-defined functions can also be supplied. Note
    that the robust menthods assumes that the data are already
    log-transformed.</p></dd>


  <dt id="arg-fcol">fcol<a class="anchor" aria-label="anchor" href="#arg-fcol"></a></dt>
<dd><p>Feature meta-data label (fData column name) defining how
    to summerise the features. It must be present in
    <code>fvarLabels(object)</code> and, if present, will be used to defined
    <code>groupBy</code> as <code>fData(object)[, fcol]</code>. Note that
    <code>fcol</code> is ignored if <code>groupBy</code> is present.</p></dd>


  <dt id="arg-redundancy-handler">redundancy.handler<a class="anchor" aria-label="anchor" href="#arg-redundancy-handler"></a></dt>
<dd><p>If <code>groupBy</code> is a <code>list</code>, one of
    <code>"unique"</code> (default) or <code>"multiple"</code> (ignored otherwise)
    defining how to handle peptides that can be associated to multiple
    higher-level features (proteins) upon combination. Using
    <code>"unique"</code> will only consider uniquely matching features
    (features matching multiple proteins will be discarded).
    <code>"multiple"</code> will allow matching to multiple proteins and each
    feature will be repeatedly tallied for each possible matching
    protein.</p></dd>


  <dt id="arg-cv">cv<a class="anchor" aria-label="anchor" href="#arg-cv"></a></dt>
<dd><p>A <code>logical</code> defining if feature coefficients of
    variation should be computed and stored as feature
    meta-data. Default is <code>TRUE</code>.</p></dd>


  <dt id="arg-cv-norm">cv.norm<a class="anchor" aria-label="anchor" href="#arg-cv-norm"></a></dt>
<dd><p>A <code>character</code> defining how to normalise the
    feature intensitites prior to CV calculation. Default is
    <code>sum</code>. Use <code>none</code> to keep intensities as is. See
    <code><a href="featureCV.html">featureCV</a></code> for more details.</p></dd>


  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical</code> indicating whether verbose output is
    to be printed out.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for the <code>fun</code> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    


<p>A new <code>"<a href="MSnSet-class.html">MSnSet</a>"</code> instance is returned with</p>
<p></p>
<p><code>ncol</code> (i.e. number of samples) is unchanged, but <code>nrow</code></p>


<p>(i.e. the number od features) is now equals to the number of levels in</p>
<p></p>
<p><code>groupBy</code>. The feature metadata (<code>featureData</code> slot) is
  updated accordingly and only the first occurrence of a feature in the
  original feature meta-data is kept.</p>


    </div>
    <div id="details">
    <h2>Details</h2>
    

<p>Missing values have different effect based on the aggregation method
  employed, as detailed below. See also examples below.</p>
<p></p><ol><li><p>When using either <code>"sum"</code>, <code>"mean"</code>,
    <code>"weighted.mean"</code> or <code>"median"</code>, any missing value will be
    propagated at the higher level. If <code>na.rm = TRUE</code> is used, then
    the missing value will be ignored.</p></li>
<li><p>Missing values will result in an error when using
    <code>"medpolish"</code>, unless <code>na.rm = TRUE</code> is used.</p></li>
<li><p>When using robust summarisation (<code>"robust"</code>), individual
    missing values are excluded prior to fitting the linear model by
    robust regression. To remove all values in the feature containing
    the missing values, use <code>filterNA</code>.</p></li>
<li><p>The <code>"iPQF"</code> method will fail with an error if missing
    value are present, which will have to be handled explicitly. See
    below.</p></li>
</ol><p>More generally, missing values often need dedicated handling such as
  filtering (see <code><a href="MSnSet-class.html">filterNA</a></code>) or imputation (see
  <code>impute</code>).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    

<p>Laurent Gatto &lt;lg390@cam.ac.uk&gt; with contributions from Martina
  Fischer for iPQF and Ludger Goeminne, Adriaan Sticker and Lieven
  Clement for robust.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>iPQF: a new peptide-to-protein summarization method using peptide
  spectra characteristics to improve protein quantification. Fischer M,
  Renard BY.  Bioinformatics. 2016 Apr
  1;32(7):1040-7. doi:10.1093/bioinformatics/btv675. Epub 2015 Nov
  20. PubMed PMID:26589272.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">

<p><code><a href="featureCV.html">featureCV</a></code> to calculate coefficient of variation,
  <code><a href="nFeatures.html">nFeatures</a></code> to document the number of features per group
  in the feature data, and the <code><a href="aggvar.html">aggvar</a></code> to explore
  variability within protein groups.</p>
<p><code><a href="iPQF.html">iPQF</a></code> for iPQF summarisation.</p>
<p><code><a href="normToReference.html">NTR</a></code> for normalisation to reference summarisation.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">msnset</span> <span class="op">&lt;-</span> <span class="va">msnset</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X19  32838.044  37066.058  41429.627  39700.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2    3715.089   4254.323   4748.462   5249.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X20  34509.686  34928.747  41911.032  42843.839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X21  21262.148  23168.729  25407.068  25949.954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X22   8635.316  10036.529   9254.432   7769.749</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## arbitrary grouping into two groups</span></span></span>
<span class="r-in"><span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">msnset.comb</span> <span class="op">&lt;-</span> <span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>, groupBy <span class="op">=</span> <span class="va">grp</span>, method <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pSet-class.html">dim</a></span><span class="op">(</span><span class="va">msnset.comb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset.comb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   36553.13   41320.38   46178.09   44950.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   64407.15   68134.01   76572.53   76563.54</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fvarLabels</a></span><span class="op">(</span><span class="va">msnset.comb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "spectrum"            "ProteinAccession"    "ProteinDescription" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "PeptideSequence"     "file"                "retention.time"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "precursor.mz"        "precursor.intensity" "charge"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "peaks.count"         "tic"                 "ionCount"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "ms.level"            "acquisition.number"  "collision.energy"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "CV.iTRAQ4.114"       "CV.iTRAQ4.115"       "CV.iTRAQ4.116"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "CV.iTRAQ4.117"      </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## grouping with a list</span></span></span>
<span class="r-in"><span><span class="va">grpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## optional naming</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">grpl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html" class="external-link">featureNames</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>, groupBy <span class="op">=</span> <span class="va">grpl</span>, method <span class="op">=</span> <span class="st">"sum"</span>, redundancy.handler <span class="op">=</span> <span class="st">"unique"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A   38224.78   39183.07   46659.49   48093.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C   21262.15   23168.73   25407.07   25949.95</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>, groupBy <span class="op">=</span> <span class="va">grpl</span>, method <span class="op">=</span> <span class="st">"sum"</span>, redundancy.handler <span class="op">=</span> <span class="st">"multiple"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A   71062.82   76249.13   88089.12   87794.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B   41473.36   47102.59   50684.06   47470.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C   29897.46   33205.26   34661.50   33719.70</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## missing data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X19  32838.044   37066.06  41429.627  39700.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2    3715.089         NA   4748.462   5249.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X20  34509.686   34928.75  41911.032  42843.839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X21  21262.148   23168.73  25407.068         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X22   8635.316   10036.53   9254.432   7769.749</span>
<span class="r-in"><span><span class="co">## NAs propagate in the 115 and 117 channels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>, <span class="va">grp</span>, <span class="st">"sum"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your data contains missing values. Please read the relevant section in</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> the combineFeatures manual page for details on the effects of missing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> values on data aggregation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   36553.13         NA   46178.09   44950.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   64407.15   68134.01   76572.53         NA</span>
<span class="r-in"><span><span class="co">## NAs are removed before summing</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>, <span class="va">grp</span>, <span class="st">"sum"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your data contains missing values. Please read the relevant section in</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> the combineFeatures manual page for details on the effects of missing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> values on data aggregation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   36553.13   37066.06   46178.09   44950.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   64407.15   68134.01   76572.53   50613.59</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## using iPQF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">anyNA</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset2</span>,</span></span>
<span class="r-in"><span>           groupBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span><span class="op">$</span><span class="va">accession</span>,</span></span>
<span class="r-in"><span>           redundancy.handler <span class="op">=</span> <span class="st">"unique"</span>,</span></span>
<span class="r-in"><span>           method <span class="op">=</span> <span class="st">"iPQF"</span>,</span></span>
<span class="r-in"><span>           low.support.filter <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>           ratio.calc <span class="op">=</span> <span class="st">"sum"</span>,</span></span>
<span class="r-in"><span>           method.combine <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following 1 proteins are only supported by 1 or 2 peptide spectra,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> hence, protein quantification is not reliable and can only be calculated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> by the 'mean' in these cases, corresponding protein accessions are:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   O95678</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X114.ions X115.ions X116.ions X117.ions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O95678 0.2404726 0.2682764 0.2584247 0.2328263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P01766 0.2610278 0.2467206 0.2544715 0.2377801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P01776 0.2678859 0.2591250 0.2423396 0.2306495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P02749 0.2640340 0.2523566 0.2510357 0.2325736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P02763 0.2503318 0.2524583 0.2501628 0.2470472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P07225 0.2533961 0.2506013 0.2504353 0.2455673</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## using robust summarisation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span> <span class="co">## reset data</span></span></span>
<span class="r-in"><span><span class="va">msnset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">msnset</span>, <span class="fl">2</span><span class="op">)</span> <span class="co">## log2 transform</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Feature X46, in the ENO protein has one missig value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     row col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2    2   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X21   4   4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">[</span><span class="st">"X46"</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (cond) .Internal(C_tryCatchHelper(addr, 1L, cond)))(structure(list(message = "subscript out of bounds",     call = orig[[nm]][i, , ..., drop = drop], object = structure(c(15.0030805728121,     11.8591811816279, 15.0747137350561, 14.3759997002879, 13.0760333393114,     15.177811062346, NA, 15.0921272743665, 14.4998912898294,     13.2929728095096, 15.3383752007826, 12.2132444458243, 15.3550424297539,     14.6329423029583, 13.1759286811449, 15.2768686547183, 12.3580752059455,     15.3868001257316, NA, 12.9236522919322), dim = 5:4, dimnames = list(        c("X19", "X2", "X20", "X21", "X22"), c("iTRAQ4.114",         "iTRAQ4.115", "iTRAQ4.116", "iTRAQ4.117"))), subscript = 1L,     index = "X46"), class = c("subscriptOutOfBoundsError", "error", "condition"))):</span> error in evaluating the argument 'object' in selecting a method for function 'exprs': subscript out of bounds</span>
<span class="r-in"><span><span class="co">## Only the missing value in X46 and iTRAQ4.116 will be ignored</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset</span>,</span></span>
<span class="r-in"><span>           fcol <span class="op">=</span> <span class="st">"ProteinAccession"</span>,</span></span>
<span class="r-in"><span>           method <span class="op">=</span> <span class="st">"robust"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your data contains missing values. Please read the relevant section in</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> the combineFeatures manual page for details on the effects of missing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> values on data aggregation.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA1032   15.00308   15.17781   15.33838   15.27687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA1104   14.37600   14.49989   14.63294         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA1294   11.85918         NA   12.21324   12.35808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA3356   13.07603   13.29297   13.17593   12.92365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA4514   15.07471   15.09213   15.35504   15.38680</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">msnset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="MSnSet-class.html">filterNA</a></span><span class="op">(</span><span class="va">msnset</span><span class="op">)</span> <span class="co">## remove features with missing value(s)</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">combineFeatures</span><span class="op">(</span><span class="va">msnset2</span>,</span></span>
<span class="r-in"><span>      fcol <span class="op">=</span> <span class="st">"ProteinAccession"</span>,</span></span>
<span class="r-in"><span>      method <span class="op">=</span> <span class="st">"robust"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Here, the values for ENO are different because the whole feature</span></span></span>
<span class="r-in"><span><span class="co">## X46 that contained the missing value was removed prior to fitting.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA1032   15.00308   15.17781   15.33838   15.27687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA3356   13.07603   13.29297   13.17593   12.92365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ECA4514   15.07471   15.09213   15.35504   15.38680</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

