<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantitative proteomics data imputation — impute,MSnSet-method • MSnbase</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quantitative proteomics data imputation — impute,MSnSet-method" />
<meta property="og:description" content="The impute method performs data imputation on MSnSet instances
using a variety of methods.
Users should proceed with care when imputing data and take
precautions to assure that the imputation produce valid results,
in particular with naive imputations such as replacing missing
values with 0.
See MsCoreUtils::impute_matrix() for details on the different
imputation methods available and strategies." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.17.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lgatto/MSnbase/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantitative proteomics data imputation</h1>
    <small class="dont-index">Source: <a href='https://github.com/lgatto/MSnbase/blob/master/R/imputation.R'><code>R/imputation.R</code></a></small>
    <div class="hidden name"><code>impute.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>impute</code> method performs data imputation on <code>MSnSet</code> instances
using a variety of methods.</p>
<p>Users should proceed with care when imputing data and take
precautions to assure that the imputation produce valid results,
in particular with naive imputations such as replacing missing
values with 0.</p>
<p>See <code><a href='https://rdrr.io/pkg/MsCoreUtils/man/imputation.html'>MsCoreUtils::impute_matrix()</a></code> for details on the different
imputation methods available and strategies.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for MSnSet</span>
<span class='fu'>impute</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>method</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An <code>MSnSet</code> object with missing values to be
imputed.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the imputation method. See
<code><a href='https://rdrr.io/pkg/MsCoreUtils/man/imputation.html'>MsCoreUtils::imputeMethods()</a></code> for available ones. See
<code><a href='https://rdrr.io/pkg/MsCoreUtils/man/imputation.html'>MsCoreUtils::impute_matrix()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passed to the inner imputation
function. See <code><a href='https://rdrr.io/pkg/MsCoreUtils/man/imputation.html'>MsCoreUtils::impute_matrix()</a></code> for details.</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>naset</span><span class='op'>)</span>

<span class='co'>## table of missing values along the rows</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'>fData</span><span class='op'>(</span><span class='va'>naset</span><span class='op'>)</span><span class='op'>$</span><span class='va'>nNA</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;   0   1   2   3   4   8   9  10 
#&gt; 301 247  91  13   2  23  10   2 </div><div class='input'>
<span class='co'>## table of missing values along the columns</span>
<span class='fu'>pData</span><span class='op'>(</span><span class='va'>naset</span><span class='op'>)</span><span class='op'>$</span><span class='va'>nNA</span>
</div><div class='output co'>#&gt;  [1] 34 45 56 39 47 52 49 61 41 42 55 45 51 43 57 53</div><div class='input'>
<span class='co'>## non-random missing values</span>
<span class='va'>notna</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>fData</span><span class='op'>(</span><span class='va'>naset</span><span class='op'>)</span><span class='op'>$</span><span class='va'>randna</span><span class='op'>)</span>
<span class='fu'><a href='pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>notna</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 35</div><div class='input'><span class='va'>notna</span>
</div><div class='output co'>#&gt;  [1]   6  20  79  88 130 187 227 231 238 264 275 317 324 363 373 382 409 437 445
#&gt; [20] 453 456 474 484 485 492 514 516 546 568 580 594 631 648 664 671</div><div class='input'>
<span class='fu'>impute</span><span class='op'>(</span><span class='va'>naset</span>, method <span class='op'>=</span> <span class='st'>"min"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; MSnSet (storageMode: lockedEnvironment)
#&gt; assayData: 689 features, 16 samples 
#&gt;   element names: exprs 
#&gt; protocolData: none
#&gt; phenoData
#&gt;   sampleNames: M1F1A M1F4A ... M2F11B (16 total)
#&gt;   varLabels: nNA
#&gt;   varMetadata: labelDescription
#&gt; featureData
#&gt;   featureNames: AT1G09210 AT1G21750 ... AT4G39080 (689 total)
#&gt;   fvarLabels: nNA randna
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; Annotation:  
#&gt; - - - Processing information - - -
#&gt; Data imputation using min Sun Dec 27 21:10:20 2020 
#&gt;  MSnbase version: 1.15.6 </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'>"imputeLCMD"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>impute</span><span class='op'>(</span><span class='va'>naset</span>, method <span class='op'>=</span> <span class='st'>"QRILC"</span><span class='op'>)</span>
    <span class='fu'>impute</span><span class='op'>(</span><span class='va'>naset</span>, method <span class='op'>=</span> <span class='st'>"MinDet"</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: imputeLCMD</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: tmvtnorm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: mvtnorm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘Matrix’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:S4Vectors’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: gmm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: sandwich</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: norm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: pcaMethods</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘pcaMethods’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    loadings</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: impute</span></div><div class='output co'>#&gt; MSnSet (storageMode: lockedEnvironment)
#&gt; assayData: 689 features, 16 samples 
#&gt;   element names: exprs 
#&gt; protocolData: none
#&gt; phenoData
#&gt;   sampleNames: M1F1A M1F4A ... M2F11B (16 total)
#&gt;   varLabels: nNA
#&gt;   varMetadata: labelDescription
#&gt; featureData
#&gt;   featureNames: AT1G09210 AT1G21750 ... AT4G39080 (689 total)
#&gt;   fvarLabels: nNA randna
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; Annotation:  
#&gt; - - - Processing information - - -
#&gt; Data imputation using MinDet Sun Dec 27 21:10:21 2020 
#&gt;  MSnbase version: 1.15.6 </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='http://www.stat.psu.edu/~jls/misoftwa.html#aut'>"norm"</a></span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'>impute</span><span class='op'>(</span><span class='va'>naset</span>, method <span class='op'>=</span> <span class='st'>"MLE"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Iterations of EM: 
#&gt; 1...2...3...4...5...6...7...8...9...10...11...</div><div class='output co'>#&gt; MSnSet (storageMode: lockedEnvironment)
#&gt; assayData: 689 features, 16 samples 
#&gt;   element names: exprs 
#&gt; protocolData: none
#&gt; phenoData
#&gt;   sampleNames: M1F1A M1F4A ... M2F11B (16 total)
#&gt;   varLabels: nNA
#&gt;   varMetadata: labelDescription
#&gt; featureData
#&gt;   featureNames: AT1G09210 AT1G21750 ... AT4G39080 (689 total)
#&gt;   fvarLabels: nNA randna
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; Annotation:  
#&gt; - - - Processing information - - -
#&gt; Data imputation using MLE Sun Dec 27 21:10:21 2020 
#&gt;  MSnbase version: 1.15.6 </div><div class='input'>
<span class='fu'>impute</span><span class='op'>(</span><span class='va'>naset</span>, <span class='st'>"mixed"</span>,
       randna <span class='op'>=</span> <span class='fu'>fData</span><span class='op'>(</span><span class='va'>naset</span><span class='op'>)</span><span class='op'>$</span><span class='va'>randna</span>,
       mar <span class='op'>=</span> <span class='st'>"knn"</span>, mnar <span class='op'>=</span> <span class='st'>"QRILC"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; MSnSet (storageMode: lockedEnvironment)
#&gt; assayData: 689 features, 16 samples 
#&gt;   element names: exprs 
#&gt; protocolData: none
#&gt; phenoData
#&gt;   sampleNames: M1F1A M1F4A ... M2F11B (16 total)
#&gt;   varLabels: nNA
#&gt;   varMetadata: labelDescription
#&gt; featureData
#&gt;   featureNames: AT1G09210 AT1G21750 ... AT4G39080 (689 total)
#&gt;   fvarLabels: nNA randna
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; Annotation:  
#&gt; - - - Processing information - - -
#&gt; Data imputation using mixed Sun Dec 27 21:10:21 2020 
#&gt;  MSnbase version: 1.15.6 </div><div class='input'>

<span class='co'>## neighbour averaging</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>naset</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/tidyeval.html'>exprs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'>## min value</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/tidyeval.html'>exprs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'>## average</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/tidyeval.html'>exprs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'>## min value and average</span>
<span class='co'>## 4th row: no imputation</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/tidyeval.html'>exprs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              M1F1A    M1F4A   M1F7A  M1F11A    M1F2B    M1F5B
#&gt; AT1G09210       NA 0.275500 0.21600 0.18525 0.465667 0.199667
#&gt; AT1G21750 0.332000 0.279667      NA 0.16600 0.451500 0.200375
#&gt; AT1G51760       NA       NA 0.16825 0.18825 0.459750 0.214500
#&gt; AT1G56340 0.336733       NA      NA      NA 0.487167 0.201833</div><div class='input'>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/tidyeval.html'>exprs</a></span><span class='op'>(</span><span class='fu'>impute</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"nbavg"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Assuming values are ordered.</span></div><div class='output co'>#&gt;              M1F1A    M1F4A     M1F7A  M1F11A    M1F2B    M1F5B
#&gt; AT1G09210 0.166000 0.275500 0.2160000 0.18525 0.465667 0.199667
#&gt; AT1G21750 0.332000 0.279667 0.2228335 0.16600 0.451500 0.200375
#&gt; AT1G51760 0.166000 0.167125 0.1682500 0.18825 0.459750 0.214500
#&gt; AT1G56340 0.336733       NA        NA      NA 0.487167 0.201833</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


