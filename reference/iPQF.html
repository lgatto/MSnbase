<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>iPQF: iTRAQ (and TMT) Protein Quantification based on Features — iPQF • MSnbase</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="iPQF: iTRAQ (and TMT) Protein Quantification based on Features — iPQF"><meta name="description" content="The iPQF spectra-to-protein summarisation method integrates
peptide spectra characteristics and quantitative values for protein
quantitation estimation. Spectra features, such as charge state,
sequence length, identification score and others, contain valuable
information concerning quantification accuracy. The iPQF algorithm
assigns weights to spectra according to their overall feature reliability
and computes a weighted mean to estimate protein quantities.
See also combineFeatures for a more
general overview of feature aggregation and examples."><meta property="og:description" content="The iPQF spectra-to-protein summarisation method integrates
peptide spectra characteristics and quantitative values for protein
quantitation estimation. Spectra features, such as charge state,
sequence length, identification score and others, contain valuable
information concerning quantification accuracy. The iPQF algorithm
assigns weights to spectra according to their overall feature reliability
and computes a weighted mean to estimate protein quantities.
See also combineFeatures for a more
general overview of feature aggregation and examples."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSnbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.35.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a></li>
    <li><a class="dropdown-item" href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a></li>
    <li><a class="dropdown-item" href="../articles/v04-benchmarking.html">MSnbase benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/MSnbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>iPQF: iTRAQ (and TMT) Protein Quantification based on Features</h1>
      <small class="dont-index">Source: <a href="https://github.com/lgatto/MSnbase/blob/master/R/iPQF.R" class="external-link"><code>R/iPQF.R</code></a></small>
      <div class="d-none name"><code>iPQF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The iPQF spectra-to-protein summarisation method integrates
peptide spectra characteristics and quantitative values for protein
quantitation estimation. Spectra features, such as charge state,
sequence length, identification score and others, contain valuable
information concerning quantification accuracy. The iPQF algorithm
assigns weights to spectra according to their overall feature reliability
and computes a weighted mean to estimate protein quantities.
See also <code><a href="combineFeatures.html">combineFeatures</a></code> for a more
general overview of feature aggregation and examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">iPQF</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">groupBy</span>,</span>
<span>  low.support.filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ratio.calc <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  method.combine <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  feature.weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>MSnSet</code> containing
absolute ion intensities.</p></dd>


<dt id="arg-groupby">groupBy<a class="anchor" aria-label="anchor" href="#arg-groupby"></a></dt>
<dd><p>Vector defining spectra to protein
matching. Generally, this is a feature variable such as
<code>fData(object)$accession</code>.</p></dd>


<dt id="arg-low-support-filter">low.support.filter<a class="anchor" aria-label="anchor" href="#arg-low-support-filter"></a></dt>
<dd><p>A <code>logical</code> specifying if proteins
being supported by only 1-2 peptide spectra should be filtered
out. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-ratio-calc">ratio.calc<a class="anchor" aria-label="anchor" href="#arg-ratio-calc"></a></dt>
<dd><p>Either <code>"none"</code> (don't calculate any
ratios), <code>"sum"</code> (default), or a specific channel (one of
<code>sampleNames(object)</code>) defining how to calculate relative
peptides intensities.</p></dd>


<dt id="arg-method-combine">method.combine<a class="anchor" aria-label="anchor" href="#arg-method-combine"></a></dt>
<dd><p>A <code>logical</code> defining whether to further
use median polish to combine features.</p></dd>


<dt id="arg-feature-weight">feature.weight<a class="anchor" aria-label="anchor" href="#arg-feature-weight"></a></dt>
<dd><p>Vector <code>"numeric"</code> giving weight to the
different features. Default is the squared order of the
features redundant -unique-distance metric, charge state, ion
intensity, sequence length, identification score, modification
state, and mass based on a robustness analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>matrix</code> with estimated protein ratios.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>iPQF: a new peptide-to-protein summarization method
using peptide spectra characteristics to improve protein
quantification. Fischer M, Renard BY.  Bioinformatics. 2016
Apr 1;32(7):1040-7. doi:10.1093/bioinformatics/btv675. Epub
2015 Nov 20. PubMed PMID:26589272.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Martina Fischer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X114.ions  X115.ions  X116.ions X117.ions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11695 7.0384398  7.6349574  7.2886949 6.7348692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11696 9.4098886 10.1034528 10.0697640 9.4273709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11697 4.5859834  4.6926775  4.5016924 4.2924254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11698 3.7262916  3.8913142  3.7928041 3.3721019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11699 1.2229379  1.4005805  1.3940034 1.2957861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11700 0.8303542  0.7397313  0.7686411 0.7402981</span>
<span class="r-in"><span><span class="va">prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="combineFeatures.html">combineFeatures</a></span><span class="op">(</span><span class="va">msnset2</span>,</span></span>
<span class="r-in"><span>                        groupBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">msnset2</span><span class="op">)</span><span class="op">$</span><span class="va">accession</span>,</span></span>
<span class="r-in"><span>                        method <span class="op">=</span> <span class="st">"iPQF"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following 1 proteins are only supported by 1 or 2 peptide spectra,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> hence, protein quantification is not reliable and can only be calculated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> by the 'mean' in these cases, corresponding protein accessions are:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   O95678</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">prot</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X114.ions X115.ions X116.ions X117.ions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O95678 0.2404726 0.2682764 0.2584247 0.2328263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P01766 0.2610278 0.2467206 0.2544715 0.2377801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P01776 0.2678859 0.2591250 0.2423396 0.2306495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P02749 0.2640340 0.2523566 0.2510357 0.2325736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P02763 0.2503318 0.2524583 0.2501628 0.2470472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P07225 0.2533961 0.2506013 0.2504353 0.2455673</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

