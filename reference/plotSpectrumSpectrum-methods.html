<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plotting a 'Spectrum' vs another 'Spectrum' object. — plot.Spectrum.Spectrum-methods • MSnbase</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting a 'Spectrum' vs another 'Spectrum' object. — plot.Spectrum.Spectrum-methods"><meta name="description" content="These method plot mass spectra MZ values against the intensities as
  line plots. The first spectrum is plotted in the upper panel and the other in
  upside down in the lower panel. Common peaks are drawn in a slightly darker
  colour. If a peptide sequence is provided it automatically calculates
  and labels the fragments."><meta property="og:description" content="These method plot mass spectra MZ values against the intensities as
  line plots. The first spectrum is plotted in the upper panel and the other in
  upside down in the lower panel. Common peaks are drawn in a slightly darker
  colour. If a peptide sequence is provided it automatically calculates
  and labels the fragments."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSnbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.35.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a></li>
    <li><a class="dropdown-item" href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a></li>
    <li><a class="dropdown-item" href="../articles/v04-benchmarking.html">MSnbase benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/MSnbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plotting a 'Spectrum' vs another 'Spectrum' object.</h1>

      <div class="d-none name"><code>plotSpectrumSpectrum-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These method plot mass spectra MZ values against the intensities as
  line plots. The first spectrum is plotted in the upper panel and the other in
  upside down in the lower panel. Common peaks are drawn in a slightly darker
  colour. If a peptide sequence is provided it automatically calculates
  and labels the fragments.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Object of class <code>"<a href="Spectrum-class.html">Spectrum</a>"</code> .</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Object of class <code>"<a href="Spectrum-class.html">Spectrum</a>"</code> .</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to internal functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    <p></p><dl><dt><code>signature(x = "Spectrum", y = "Spectrum", ...)</code></dt>
<dd><p>Plots two spectra against each other. Common peaks are drawn in a slightly
      darker colour.
      The <code>...</code> arguments are passed to the internal functions.
      Currently <code>tolerance</code>, <code>relative</code>, <code>sequences</code> and most of
      the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code> arguments (like <code>xlim</code>, <code>ylim</code>,
      <code>main</code>, <code>xlab</code>, <code>ylab</code>, ...) are supported.
      You could change the <code>tolerance</code> (default <code>25e-6</code>) and
      decide whether this tolerance should be applied relative
      (default <code>relative = TRUE</code>) or absolute (<code>relative = FALSE</code>)
      to find and colour common peaks.
      Use a <code>character</code> vector of length 2 to provide <code>sequences</code>
      which would be used to calculate and draw the corresponding fragments.
      If <code>sequences</code> are given the
      <code>type</code> argument (default: <code>type=c("b", "y")</code> specify the
      fragment types which should calculated. Also it is possible to allow some
      <code>modifications</code>. Therefore you have to apply a named <code>character</code>
      vector for <code>modifications</code> where the name corresponds to the
      one-letter-code of the modified amino acid
      (default: Carbamidomethyl <code>modifications=c(C=57.02146)</code>). Additional
      you can specifiy the type of <code>neutralLoss</code> (default:
      <code><a href="https://rdrr.io/pkg/PSMatch/man/calculateFragments.html" class="external-link">PSMatch::defaultNeutralLoss()</a></code>).
      See <code><a href="calculateFragments-methods.html">calculateFragments</a></code> for details.</p>
<p>There are a lot of graphical arguments available to control the
      representation of the peaks and fragments. Use <code>peaks.pch</code> to set the
      character on top of the peaks (default: <code>peaks.pch=19</code>). In a similar
      way you can set the line width <code>peaks.lwd=1</code> and the magnification
      <code>peaks.cex=0.5</code> of the peaks. The size of the fragment/legend labels could
      be set using <code>fragments.cex=0.75</code> or <code>legend.cex</code> respectively.
      See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code> for details about graphical parameters in general.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Gibb &lt;mail@sebastiangibb.de&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>More spectrum plotting available in <code><a href="plot-methods.html">plot.Spectrum</a></code>.</p>
<p>More details about fragment calculation: <code><a href="calculateFragments-methods.html">calculateFragments</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## find path to a mzXML file</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"MSnbase"</span>, dir <span class="op">=</span> <span class="st">"extdata"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            full.name <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"mzXML$"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create basic MSnExp</span></span></span>
<span class="r-in"><span><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="readMSData.html">readMSData</a></span><span class="op">(</span><span class="va">file</span>, centroided.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## centroid them</span></span></span>
<span class="r-in"><span><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> unable to find an inherited method for function ‘pickPeaks’ for signature ‘object = "MSnExp"’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot the first against the second spectrum</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">msexp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your spectrum is not centroided.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your spectrum is not centroided.</span>
<span class="r-plt img"><img src="plotSpectrumSpectrum-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## add sequence information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">msexp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, sequences<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VESITARHGEVLQLRPK"</span>,</span></span>
<span class="r-in"><span>                                         <span class="st">"IDGQWVTHQWLKK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your spectrum is not centroided.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'modifications' is deprecated, please use 'fixed_modifications' instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your spectrum is not centroided.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'modifications' is deprecated, please use 'fixed_modifications' instead.</span>
<span class="r-plt img"><img src="plotSpectrumSpectrum-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">itraqdata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> unable to find an inherited method for function ‘pickPeaks’ for signature ‘object = "MSnExp"’</span>
<span class="r-in"><span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span>, <span class="st">"PeptideSequence"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"TAGIQIVADDLTVTNPK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'which': error in evaluating the argument 'object' in selecting a method for function 'fData': object 'itraqdata2' not found</span>
<span class="r-in"><span><span class="va">mzk</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectrum2-class.html">precursorMz</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'precursorMz': object 'itraqdata2' not found</span>
<span class="r-in"><span><span class="va">zk</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectrum2-class.html">precursorCharge</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'precursorCharge': object 'itraqdata2' not found</span>
<span class="r-in"><span><span class="va">mzk</span> <span class="op">*</span> <span class="va">zk</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mzk' not found</span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">[[</span><span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">itraqdata2</span><span class="op">[[</span><span class="va">k</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'itraqdata2' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

