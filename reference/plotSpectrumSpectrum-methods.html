<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plotting a 'Spectrum' vs another 'Spectrum' object. — plot.Spectrum.Spectrum-methods • MSnbase</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting a 'Spectrum' vs another 'Spectrum' object. — plot.Spectrum.Spectrum-methods"><meta property="og:description" content="These method plot mass spectra MZ values against the intensities as
  line plots. The first spectrum is plotted in the upper panel and the other in
  upside down in the lower panel. Common peaks are drawn in a slightly darker
  colour. If a peptide sequence is provided it automatically calculates
  and labels the fragments."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.29.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lgatto/MSnbase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting a 'Spectrum' vs another 'Spectrum' object.</h1>
    
    <div class="hidden name"><code>plotSpectrumSpectrum-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These method plot mass spectra MZ values against the intensities as
  line plots. The first spectrum is plotted in the upper panel and the other in
  upside down in the lower panel. Common peaks are drawn in a slightly darker
  colour. If a peptide sequence is provided it automatically calculates
  and labels the fragments.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Object of class <code>"<a href="Spectrum-class.html">Spectrum</a>"</code> .</p></dd>

  <dt>y</dt>
<dd><p>Object of class <code>"<a href="Spectrum-class.html">Spectrum</a>"</code> .</p></dd>

  <dt>...</dt>
<dd><p>Further arguments passed to internal functions.</p></dd>

</dl></div>
    <div id="methods">
    <h2>Methods</h2>
    <p></p><dl><dt><code>signature(x = "Spectrum", y = "Spectrum", ...)</code></dt>
<dd><p>Plots two spectra against each other. Common peaks are drawn in a slightly
      darker colour.
      The <code>...</code> arguments are passed to the internal functions.
      Currently <code>tolerance</code>, <code>relative</code>, <code>sequences</code> and most of
      the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code> arguments (like <code>xlim</code>, <code>ylim</code>,
      <code>main</code>, <code>xlab</code>, <code>ylab</code>, ...) are supported.
      You could change the <code>tolerance</code> (default <code>25e-6</code>) and
      decide whether this tolerance should be applied relative
      (default <code>relative = TRUE</code>) or absolute (<code>relative = FALSE</code>)
      to find and colour common peaks.
      Use a <code>character</code> vector of length 2 to provide <code>sequences</code>
      which would be used to calculate and draw the corresponding fragments.
      If <code>sequences</code> are given the
      <code>type</code> argument (default: <code>type=c("b", "y")</code> specify the
      fragment types which should calculated. Also it is possible to allow some
      <code>modifications</code>. Therefore you have to apply a named <code>character</code>
      vector for <code>modifications</code> where the name corresponds to the
      one-letter-code of the modified amino acid
      (default: Carbamidomethyl <code>modifications=c(C=57.02146)</code>). Additional
      you can specifiy the type of <code>neutralLoss</code> (default:
      <code><a href="https://rdrr.io/pkg/PSMatch/man/calculateFragments.html" class="external-link">PSMatch::defaultNeutralLoss()</a></code>).
      See <code><a href="calculateFragments-methods.html">calculateFragments</a></code> for details.</p>
<p>There are a lot of graphical arguments available to control the
      representation of the peaks and fragments. Use <code>peaks.pch</code> to set the
      character on top of the peaks (default: <code>peaks.pch=19</code>). In a similar
      way you can set the line width <code>peaks.lwd=1</code> and the magnification
      <code>peaks.cex=0.5</code> of the peaks. The size of the fragment/legend labels could
      be set using <code>fragments.cex=0.75</code> or <code>legend.cex</code> respectively.
      See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code> for details about graphical parameters in general.</p></dd>

  
</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Gibb &lt;mail@sebastiangibb.de&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>More spectrum plotting available in <code><a href="plot-methods.html">plot.Spectrum</a></code>.</p>
<p>More details about fragment calculation: <code><a href="calculateFragments-methods.html">calculateFragments</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## find path to a mzXML file</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"MSnbase"</span>, dir <span class="op">=</span> <span class="st">"extdata"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            full.name <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"mzXML$"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create basic MSnExp</span></span></span>
<span class="r-in"><span><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="readMSData.html">readMSData</a></span><span class="op">(</span><span class="va">file</span>, centroided.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## centroid them</span></span></span>
<span class="r-in"><span><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot the first against the second spectrum</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">msexp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotSpectrumSpectrum-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## add sequence information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">msexp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, sequences<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VESITARHGEVLQLRPK"</span>,</span></span>
<span class="r-in"><span>                                         <span class="st">"IDGQWVTHQWLKK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotSpectrumSpectrum-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">itraqdata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span>, <span class="st">"PeptideSequence"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"TAGIQIVADDLTVTNPK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 41 42</span>
<span class="r-in"><span><span class="va">mzk</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectrum2-class.html">precursorMz</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">zk</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectrum2-class.html">precursorCharge</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mzk</span> <span class="op">*</span> <span class="va">zk</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      X46      X47 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2046.175 2045.169 </span>
<span class="r-in"><span><span class="fu"><a href="plot-methods.html">plot</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">[[</span><span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">itraqdata2</span><span class="op">[[</span><span class="va">k</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotSpectrumSpectrum-methods-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

