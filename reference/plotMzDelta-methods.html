<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The delta m/z plot — plotMzDelta-methods • MSnbase</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="The delta m/z plot — plotMzDelta-methods"><meta property="og:description" content="The m/z delta plot illustrates the suitability of MS2 spectra for
  identification by plotting the m/z differences of the most intense
  peaks. The resulting histogram should optimally shown outstanding bars
  at amino acid residu masses. The plots have been described in Foster
  et al 2011.
Only a certain percentage of most intense MS2 peaks are taken into
  account to use the most significant signal. Default value is 10% (see
  percentage argument). The difference between peaks is then
  computed for all individual spectra and their distribution is plotted
  as a histogram where single bars represent 1 m/z differences. Delta
  m/z between 40 and 200 are plotted by default, to encompass the
  residue masses of all amino acids and several common contaminants,
  although this can be changes with the xlim argument.
In addition to the processing described above, isobaric reporter tag
  peaks (see the reporters argument) and the  precursor peak (see
  the precMz argument) can also be removed from the MS2 spectrum,
  to avoid interence with the fragment peaks.
Note that figures in Foster et al 2011 have been produced and
  optimised for centroided data. Application of the plot as is for data
  in profile mode has not been tested thoroughly, although the example
  below suggest that it might work.  
The methods make use the ggplot2 system. An object of class
  ggplot is returned invisibly.
Most of the code for plotMzDelta has kindly been contributed by
  Guangchuang Yu."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.31.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lgatto/MSnbase/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The delta m/z plot</h1>
    
    <div class="hidden name"><code>plotMzDelta-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The m/z delta plot illustrates the suitability of MS2 spectra for
  identification by plotting the m/z differences of the most intense
  peaks. The resulting histogram should optimally shown outstanding bars
  at amino acid residu masses. The plots have been described in Foster
  <em>et al</em> 2011.</p>
<p>Only a certain percentage of most intense MS2 peaks are taken into
  account to use the most significant signal. Default value is 10% (see
  <code>percentage</code> argument). The difference between peaks is then
  computed for all individual spectra and their distribution is plotted
  as a histogram where single bars represent 1 m/z differences. Delta
  m/z between 40 and 200 are plotted by default, to encompass the
  residue masses of all amino acids and several common contaminants,
  although this can be changes with the <code>xlim</code> argument.</p>
<p>In addition to the processing described above, isobaric reporter tag
  peaks (see the <code>reporters</code> argument) and the  precursor peak (see
  the <code>precMz</code> argument) can also be removed from the MS2 spectrum,
  to avoid interence with the fragment peaks.</p>
<p>Note that figures in Foster <em>et al</em> 2011 have been produced and
  optimised for centroided data. Application of the plot as is for data
  in profile mode has not been tested thoroughly, although the example
  below suggest that it might work.</p>  
<p>The methods make use the <code>ggplot2</code> system. An object of class
  <code>ggplot</code> is returned invisibly.</p>
<p>Most of the code for plotMzDelta has kindly been contributed by
  Guangchuang Yu.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code>MSnExp</code> or <code>mzRramp</code>
    (from the <code>mzR</code> package) containing MS2 spectra.</p></dd>
 
  <dt id="arg-reporters">reporters<a class="anchor" aria-label="anchor" href="#arg-reporters"></a></dt>
<dd><p>An object of class class
    <code>"<a href="ReporterIons-class.html">ReporterIons</a>"</code> that defines which reporter ion
    peaks to set to 0. The default value <code>NULL</code> leaves the spectra
    as they are.</p></dd>

  <dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>A numeric between 0 and 1 to use a subset of 
    <code>object</code>'s MS2 spectra.</p></dd>
 
  <dt id="arg-percentage">percentage<a class="anchor" aria-label="anchor" href="#arg-percentage"></a></dt>
<dd><p>The percentage of most intense peaks to be used for
    the plot. Default is 0.1.</p></dd>

  <dt id="arg-precmz">precMz<a class="anchor" aria-label="anchor" href="#arg-precmz"></a></dt>
<dd><p>A <code>numeric</code> of length one or <code>NULL</code>
    default. In the latter (and preferred) case, the precursor m/z
    values are extracted from the individual MS2 spectra using the
    <code><a href="Spectrum2-class.html">precursorMz</a></code> method.</p></dd>

  <dt id="arg-precmzwidth">precMzWidth<a class="anchor" aria-label="anchor" href="#arg-precmzwidth"></a></dt>
<dd><p>A <code>numeric</code> of length 1 that specifies the 
    width around the precursor m/z where peaks are set to 0. Default is
    2.</p></dd>

  <dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>A <code>numeric</code> specifying the bandwith to be used to bin
    the delta m/z value to plot the histogram. Default if 1. See
    <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></code> for more details.</p></dd>

  <dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>A <code>numeric</code> of length 2 specifying the range of
    delta m/z to plot on the histogram. Default is <code>c(40,200)</code>.</p></dd>

  <dt id="arg-withlabels">withLabels<a class="anchor" aria-label="anchor" href="#arg-withlabels"></a></dt>
<dd><p>A <code>logical</code> defining if amino acid residue
    labels are plotted on the figure. Default is <code>TRUE</code>.</p></dd>

  <dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>A <code>numeric</code> of length 1 specifying the font size of
    amino acids lables. Default is 2.5.</p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>A <code>logical</code> of length 1 that defines whether the
    figure should be plotted on the active device. Default is
    <code>TRUE</code>. Note that the <code>ggplot</code> object is always returned
    invisibly.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical</code> of length 1 specifying whether
    textual output and a progress bar illustration the progress of data
    processing should be printed. Default is <code>TRUE</code></p></dd>

</dl></div>
    <div id="methods">
    <h2>Methods</h2>
    <p></p><dl><dt><code>signature(object = "MSnExp", ...)</code></dt>
<dd><p>Plots and (invisibly) returns the m/z delta histogram.</p></dd>

  
</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The <code><a href="plotDensity-methods.html">plotDensity</a></code> and <code><a href="plot2d-methods.html">plot2d</a></code> methods for
  other QC plots.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Foster JM, Degroeve S, Gatto L, Visser M, Wang R, Griss J, Apweiler R,
  Martens L. "A posteriori quality control for the curation and reuse of
  public proteomics data." <em>Proteomics</em>, 2011
  Jun;11(11):2182-94. doi:10.1002/pmic.201000602. Epub 2011 May 2.
  PMID: 21538885</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Laurent Gatto &lt;lg390@cam.ac.uk&gt; and Guangchuang Yu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mzdplot</span> <span class="op">&lt;-</span> <span class="fu">plotMzDelta</span><span class="op">(</span><span class="va">itraqdata</span>,</span></span>
<span class="r-in"><span>                       subset <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                       reporters <span class="op">=</span> <span class="va">iTRAQ4</span>,</span></span>
<span class="r-in"><span>                       verbose <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## let's retrieve peptide sequence information</span></span></span>
<span class="r-in"><span><span class="co">## and get a table of amino acids</span></span></span>
<span class="r-in"><span><span class="va">peps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span><span class="op">$</span><span class="va">PeptideSequence</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">peps</span>,<span class="st">""</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## table of aas</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">aas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> aas</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A  C  D  E  F  G  H  I  K  L  M  N  P  Q  R  S  T  V  W  Y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  1 53 49 12 53  6 32 41 63 16 26 20 29 14 36 47 58  3 13 </span>
<span class="r-in"><span><span class="co">## mzDelta plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mzdplot</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `after_stat(density)` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">MSnbase</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/lgatto/MSnbase/issues&gt;</span>.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_bar()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_vline()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_text()`).</span>
<span class="r-plt img"><img src="plotMzDelta-methods-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

