<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plotting 'MSnExp' and 'Spectrum' object(s) — plot-methods • MSnbase</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting 'MSnExp' and 'Spectrum' object(s) — plot-methods"><meta name="description" content="

These methods provide the functionality to plot mass spectrometry data
  provided as MSnExp,
  OnDiskMSnExp or Spectrum
  objects. Most functions plot mass spectra M/Z values against
  intensities.
Full spectra (using the full parameter) or specific peaks of
  interest can be plotted using the reporters parameter. If
  reporters are specified and full is set to 'TRUE', a
  sub-figure of the reporter ions is inlaid inside the full spectrum.
If an &quot;MSnExp&quot; is provided as argument, all the
  spectra are aligned vertically. Experiments can be subset to
  extract spectra of interest using the [ operator or
  extractPrecSpectra methods.
Most methods make use the ggplot2 system in which case an
  object of class 'ggplot' is returned invisibly.
If a single &quot;Spectrum2&quot; and a &quot;character&quot;
  representing a valid peptide sequence are passed as argument, the
  expected fragement ions are calculated and matched/annotated on the
  spectum plot."><meta property="og:description" content="

These methods provide the functionality to plot mass spectrometry data
  provided as MSnExp,
  OnDiskMSnExp or Spectrum
  objects. Most functions plot mass spectra M/Z values against
  intensities.
Full spectra (using the full parameter) or specific peaks of
  interest can be plotted using the reporters parameter. If
  reporters are specified and full is set to 'TRUE', a
  sub-figure of the reporter ions is inlaid inside the full spectrum.
If an &quot;MSnExp&quot; is provided as argument, all the
  spectra are aligned vertically. Experiments can be subset to
  extract spectra of interest using the [ operator or
  extractPrecSpectra methods.
Most methods make use the ggplot2 system in which case an
  object of class 'ggplot' is returned invisibly.
If a single &quot;Spectrum2&quot; and a &quot;character&quot;
  representing a valid peptide sequence are passed as argument, the
  expected fragement ions are calculated and matched/annotated on the
  spectum plot."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSnbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.35.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a></li>
    <li><a class="dropdown-item" href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a></li>
    <li><a class="dropdown-item" href="../articles/v04-benchmarking.html">MSnbase benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lgatto/MSnbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plotting 'MSnExp' and 'Spectrum' object(s)</h1>

      <div class="d-none name"><code>plot-methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>These methods provide the functionality to plot mass spectrometry data
  provided as <code><a href="MSnExp-class.html">MSnExp</a></code>,
  <code><a href="OnDiskMSnExp-class.html">OnDiskMSnExp</a></code> or <code><a href="Spectrum-class.html">Spectrum</a></code>
  objects. Most functions plot mass spectra M/Z values against
  intensities.</p>
<p>Full spectra (using the <code>full</code> parameter) or specific peaks of
  interest can be plotted using the <code>reporters</code> parameter. If
  <code>reporters</code> are specified and <code>full</code> is set to 'TRUE', a
  sub-figure of the reporter ions is inlaid inside the full spectrum.</p>
<p>If an <code>"<a href="MSnExp-class.html">MSnExp</a>"</code> is provided as argument, all the
  spectra are aligned vertically. Experiments can be subset to
  extract spectra of interest using the <code>[</code> operator or
  <code><a href="extractPrecSpectra-methods.html">extractPrecSpectra</a></code> methods.</p>
<p>Most methods make use the <code>ggplot2</code> system in which case an
  object of class 'ggplot' is returned invisibly.</p>
<p>If a single <code>"<a href="Spectrum2-class.html">Spectrum2</a>"</code> and a <code>"character"</code>
  representing a valid peptide sequence are passed as argument, the
  expected fragement ions are calculated and matched/annotated on the
  spectum plot.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Objects of class <code>"<a href="Spectrum-class.html">Spectrum</a>"</code>,
    <code>"<a href="Spectrum2-class.html">Spectrum2</a>"</code> or <code>"<a href="MSnExp-class.html">MSnExp</a>"</code> to
    be plotted.</p></dd>


  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Missing, <code>"<a href="Spectrum-class.html">Spectrum</a>"</code> or
  <code>"character"</code>.</p></dd>


  <dt id="arg-reporters">reporters<a class="anchor" aria-label="anchor" href="#arg-reporters"></a></dt>
<dd><p>An object of class
    <code>"<a href="ReporterIons-class.html">ReporterIons</a>"</code> that defines the peaks to be
    plotted. If not specified, <code>full</code> must be set to 'TRUE'.</p></dd>


  <dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p>Logical indicating whether full spectrum (respectively
    spectra) of  only reporter ions of interest should be
    plotted. Default is 'FALSE', in which case <code>reporters</code> must be
    defined.</p></dd>


  <dt id="arg-centroided-">centroided.<a class="anchor" aria-label="anchor" href="#arg-centroided-"></a></dt>
<dd><p>Logical indicating if spectrum or spectra are in
    centroided mode, in which case peaks are plotted as histograms,
    rather than curves.</p></dd>


  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical specifying whether plot should be printed to
    current device. Default is 'TRUE'.</p></dd>


  <dt id="arg-w-">w1<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Width of sticks for full centroided spectra. Default is to
    use maximum MZ value divided by 500.</p></dd>


  <dt id="arg-w-">w2<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Width of histogram bars for centroided reporter ions
    plots. Default is 0.01.</p></dd>


</dl><p>See below for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    <p></p><dl><dt><code>plot(signature(x = "MSnExp", y = "missing"),
        type = c("spectra", "XIC"), reporters = "ReporterIons",
        full = "logical", plot = "logical", ...)</code></dt>
<dd>

<p>For <code>type = "spectra"</code>: Plots all the spectra in the
      <code>MSnExp</code> object vertically. One of <code>reporters</code> must be
      defined or <code>full</code> set to 'TRUE'. In case of <code>MSnExp</code>
      objects, repoter ions are not inlaid when <code>full</code> is 'TRUE'.</p>
<p>For <code>type = "XIC"</code>: Plots a combined plot of retention time
      against m/z values and retention time against largest signal per
      spectrum for each file. Data points are colored by intensity. The
      lower part of the plot represents the location of the individual
      signals in the retention time - m/z space, the upper part the base
      peak chromatogram of the data (i.e. the largest signal for each
      spectrum). This plot type is restricted to MS level 1 data and is
      most useful for LC-MS data.
      Ideally, the <code>MSnExp</code> (or <code>OnDiskMSnExp</code>)
      object should be filtered first using the <code><a href="MSnExp-class.html">filterRt</a></code>
      and <code><a href="trimMz-methods.html">filterMz</a></code> functions to narrow on an ion of
      interest. See examples below. This plot uses base R
      plotting. Additional arguments to the <code>plot</code> function can be
      passed with <code>...</code>.</p>
<p>Additional arguments for <code>type = "XIC"</code> are:</p><dl><dt><code>col</code></dt>
<dd><p>color for the border of the points. Defaults to
          <code>col = "grey"</code>.</p></dd>


        <dt><code>colramp</code></dt>
<dd><p>color function/ramp to be used for the
          intensity-dependent background color of data points. Defaults
          to <code>colramp = topo.colors</code>.</p></dd>


        <dt><code>grid.color</code></dt>
<dd><p>color for the grid lines. Defaults to
          <code>grid.color = "lightgrey"</code>; use <code>grid.color = NA</code> to
          disable grid lines altogether.</p></dd>


        <dt><code>pch</code></dt>
<dd><p>point character. Defaults to <code>pch = 21</code></p></dd>
.

        <dt><code>...</code></dt>
<dd><p>additional parameters for the low-level
          <code>plot</code> function.</p></dd>



</dl><p></p></dd>

    <dt><code>plot(signature(x = "Spectrum", y = "missing"), reporters =
        "ReporterIons", full = "logical", centroided. = "logical", plot =
        "logical", w1, w2)</code></dt>
<dd><p>Displays the MZs against intensities of
      the <code>Spectrum</code> object as a line plot.
      At least one of <code>reporters</code> being defined or <code>full</code>
      set to 'TRUE' is required.
      <code>reporters</code> and <code>full</code> are used only for
      <code>"<a href="Spectrum2-class.html">Spectrum2</a>"</code>
      objects. Full <code>"<a href="Spectrum1-class.html">Spectrum1</a>"</code> spectra are plotted
      by default.</p></dd>


    <dt><code>plot(signature(x = "Spectrum2", y = "character"), orientation
        = "numeric", add = "logical", col = "character", pch, xlab =
        "character", ylab = "character", xlim = "numeric", ylim =
        "numeric", tolerance = "numeric", relative = "logical", type =
        "character", modifications = "numeric", x = "numeric", fragments
        = "data.frame", fragments.cex = "numeric", ... )</code></dt>
<dd><p>Plots a single
        MS2 spectrum and annotates the fragment ions based on the
        matching between the peaks in <code>x</code> and the fragment peaks
        calculated from the peptide sequence <code>y</code>. The default
        values are <code>orientation=1</code>, <code>add=FALSE</code>,
        <code>col="#74ADD1"</code>, <code>pch=NA</code>, <code>xlab="m/z"</code>,
        <code>ylab="intensity"</code>, <code>ylim=c(0, 1)</code>,
        <code>tolerance=25e-6</code>, relative=TRUE, type=c("b", "y"),
        <code>modifications=c(C=160.030649)</code>, <code>z=1</code>,
        fragments=<code>MSnbase:::calculateFragments_Spectrum2</code> and
        <code>fragments.cex=0.75</code>. Additional arguments <code>...</code> are
        passed to <code>plot.default</code>.</p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calculateFragments-methods.html">calculateFragments</a></code> to calculate ions produced by
  fragmentation and <code><a href="plotSpectrumSpectrum-methods.html">plot.Spectrum.Spectrum</a></code> to plot and
  compare 2 spectra and their shared peaks.</p>
<p><code><a href="Chromatogram-class.html">Chromatogram</a></code> for plotting of chromatographic data.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laurent Gatto, Johannes Rainer and Sebastian Gibb</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plotting experiments</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">itraqdata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, reporters <span class="op">=</span> <span class="va">iTRAQ4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">itraqdata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## plotting spectra</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">itraqdata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,reporters <span class="op">=</span> <span class="va">iTRAQ4</span>, full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">itraqdata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pickPeaks-method.html">pickPeaks</a></span><span class="op">(</span><span class="va">itraqdata</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> unable to find an inherited method for function ‘pickPeaks’ for signature ‘object = "MSnExp"’</span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">14</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">)</span><span class="op">[</span><span class="va">i</span>, <span class="st">"PeptideSequence"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'fData': object 'itraqdata2' not found</span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">itraqdata2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">s</span>, main <span class="op">=</span> <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'itraqdata2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load profile-mode LC-MS files</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">msdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu"><a href="readMSData.html">readMSData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sciex"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"onDisk"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Restrict the MS data to signal for serine</span></span></span>
<span class="r-in"><span><span class="va">serine</span> <span class="op">&lt;-</span> <span class="fu"><a href="trimMz-methods.html">filterMz</a></span><span class="op">(</span><span class="fu"><a href="MSnExp-class.html">filterRt</a></span><span class="op">(</span><span class="va">od</span>, rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">175</span>, <span class="fl">190</span><span class="op">)</span><span class="op">)</span>, mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">106.04</span>, <span class="fl">106.06</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">serine</span>, type <span class="op">=</span> <span class="st">"XIC"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-methods-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Same plot but using heat.colors, rectangles and no point border</span></span></span>
<span class="r-in"><span><span class="fu">plot</span><span class="op">(</span><span class="va">serine</span>, type <span class="op">=</span> <span class="st">"XIC"</span>, pch <span class="op">=</span> <span class="fl">22</span>, colramp <span class="op">=</span> <span class="va">heat.colors</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-methods-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

